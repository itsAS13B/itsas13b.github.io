<!doctype html>
<html lang="en">

<head>

<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<meta name="viewport" content="width=device-width, initial-scale=1">
  
  
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  
  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="https://fengyuanchen.github.io/pickerjs/css/picker.css">
  <link rel="stylesheet" href="https://fengyuanchen.github.io/pickerjs/css/main.css">

  <link rel="icon" href="https://www.speedrun.com/themes/Default/1st.png">
  <title>Getting Over It Leaderboard</title>

  <script src="https://fengyuanchen.github.io/pickerjs/js/picker.js"></script>

  <script src="https://fengyuanchen.github.io/pickerjs/js/main.js"></script>
  
  
  <script src="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/datejs/date.js"></script>

  <!-- <script src="res2.js"></script> 27 apr 2020 -->
  <!-- <script src="res3.js"></script> 27 june 2020 -->
  <script src="res4.js"></script> <!-- 15 dec 2020 -->

  
  <style>
  
	body{
	background: url("https://www.speedrun.com/themes/goiwbf/background.png?v=bd30d704");
	background-position-y: -207px;
	
	background-attachment: fixed;
	background-position: center;
	background-size: cover;
	background-repeat: repeat;
	}

	.flags{
	padding-right: 2px; width: 30px;
	}
	
	.trophy {
	padding-right: 5px;
	width: 18px;
	}

	.table > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th {
    border-top: 1px solid #0000005c;
	}
	
	.table-hover > tbody > tr:hover {
    background-color: #ffffff0a;
	}

	a {
    color: #6ebcff;
    text-decoration: none;
    padding-right: 13px;
	}

	a:focus, a:hover {
    color: #6ebcff;
    text-decoration: underline;
	}
	
	.form-control {
    display: initial;
    width: 15%;
    height: 39px;
    padding: 6px 15px;
	}

	.table { 
	border-collapse: separate;
    border-spacing: 0;
	}
  </style>
  
</head>

<script>

var topX = new Array(); //<--- This will be the final list containing the top x
//--------------------------------------------------------------------------------

var sortbydate = new Array();
var users = new Array();
var withoutobsoleteruns = new Array();
var speed = 6;
var x = 0;
var i = 0;
function doAjax(x) {
   setTimeout(function(){  $.ajax({
		type: "GET", 
        dataType: 'text',
        url: "https://www.speedrun.com/api/v1/runs?game=pd0wx9w1&max=200&status=verified&offset="+x,
        async: false,
        contentType: "text",
        success: function (msg) {

          var myArr = JSON.parse(msg);
          
          for(var i = 0 ; i <  myArr['data'].length ; i++ )
          {
            res.push(myArr['data'][i]);
          }
        }
    });
	x += 200; if( x > 4000 )return; doAjax(x); }, 500);
	
}

function doAjax2(i)
{
	setTimeout(function(){  
		$.ajax({
			type: "get",
			async:false,
			url: "https://www.speedrun.com/api/v1/users/"+res[i]['players'][0]['id'],
			success: function (response) {
				res[i]['players'][0]['name'] = response['data']['names']['international'];
				res[i]['players'][0]['weblink'] = response['data']['weblink'];
				res[i]['players'][0]['countrycode'] = response['data']['location'] == null ? "" : response['data']['location']['country']['code'] ;
				res[i]['players'][0]['countryname'] = response['data']['location'] == null ? "" : response['data']['location']['country']['names']['international'];
			}
		});
		
		i++; if(i > res.length)return; doAjax2(i); 
		
	}, 250);
}


function allVerifiedRunsSortedByGametime()
{
<!-- //GETTING ALL VERIFIED RUNS -->
<!-- doAjax(x); -->
	
<!-- //ADDING PLAYERS NAME TO EACH RUN -->
<!-- doAjax2(i); -->

//SORTING BY GAMETIME
	res.sort(function(a, b){return a['times']['primary_t'] - b['times']['primary_t']});
}


allVerifiedRunsSortedByGametime();
//The allVerifiedRunsSortedByGametime() function has to be called atleast once before calling this
//since we use the result from it here
function runsByDate(y,m,d,h,min,s,X)
{
//SORTING BY A SPECIFIC DATE
	sortbydate.length = 0;	
	for(var o = 0 ; o < res.length ; o++)
	{
		var d1 = new Date(y,m,d);
		
		d1.setHours(h);
		d1.setMinutes(m); 
		d1.setSeconds(s);
		var d2 = new Date(	res[o]['submitted'].split('T')[0].split('-')[0]  ,
							res[o]['submitted'].split('T')[0].split('-')[1]  ,
							res[o]['submitted'].split('T')[0].split('-')[2]  );
		d2.setHours(res[o]['submitted'].split('T')[1].split(':')[0]);
		d2.setMinutes(res[o]['submitted'].split('T')[1].split(':')[1]); 
		d2.setSeconds(res[o]['submitted'].split('T')[1].split(':')[2].split('Z')[0])
		
		if( d2.getTime() <= d1.getTime()  ){
		sortbydate.push( res[o] );
		}
	}
	
//REMOVING OBSOLETE RUNS
	users.length = 0;
	withoutobsoleteruns.length = 0;
	for(var o = 0 ; o < sortbydate.length ; o++)
	{
		if( !users.includes( sortbydate[o]['players'][0].id ) )
		{
			users.push(sortbydate[o]['players'][0].id);
			withoutobsoleteruns.push(sortbydate[o]);
		}
	}

//TOP X
	topX.length = 0;
	for(var o = 0 ; o < X ; o++)
	{ topX.push(withoutobsoleteruns[o]); }
}

var completeDate = new Date(2017,09,21,0,0,0);
var startingDate = new Date(2017,09,21,0,0,0);


var topXn = 10;
function getRuns()
{

	runsByDate(completeDate.getFullYear(),
			   completeDate.getMonth()+1,
			   completeDate.getDate(),
			   completeDate.getHours(),
			   completeDate.getMinutes(),
			   completeDate.getSeconds(),topXn);
	
	completeDate.add(speed).hours();
  
	document.getElementById('t').innerHTML = '<col width="15"> <col width="150"> <col width="160">';

	for( var i = 0 ; i < topX.length ; i++)
	{
		if( i == topXn ) break;
		
		var
		m = topX[i]['times']['primary'].split('PT')[1].split('M')[0]+'m ',
		s = topX[i]['times']['primary'].split('PT')[1].split('M')[1].split('.')[0].split('S')[0] + 's ' ,
		ms;
		withoutobsoleteruns[i]['times']['primary'].split('PT')[1].split('M')[1].split('.').length == 1 ?
		ms = '' : ms = withoutobsoleteruns[i]['times']['primary'].split('PT')[1].split('M')[1].split('.')[1].split('S')[0]+'ms';
		
		document.getElementById('t').innerHTML += 
		'<tr> <td style="text-align: center; padding-right: 0px; "  > '+ (i+1 < 4 ? '<img class="trophy" src="https://www.speedrun.com/themes/goiwbf/'+ (i+1 == 1? '1st' : (i+1 == 2?'2nd' : '3rd' ) ) +'.png" >' : '' ) + (i+1) + ' </td> <td style="text-align: center;"> ' + (topX[i]['players'][0]['countrycode'] == ''? '' : '<img src="https://www.speedrun.com/images/flags/'+topX[i]['players'][0]['countrycode']+'.png " class="flags">  ')  + topX[i]['players'][0]['name'] + ' </td> <td style="text-align: center;"> <a target="_blank" href="'+ 
		topX[i]['weblink']  +'">' + m		+ s		+ ms + '</a> '+topX[i]['date']+' </td> </tr>';
	}
}


function getRunsRewind()
{

	runsByDate(completeDate.getFullYear(),
			   completeDate.getMonth()+1,
			   completeDate.getDate(),
			   completeDate.getHours(),
			   completeDate.getMinutes(),
			   completeDate.getSeconds(),topXn);
	
	completeDate.add(-speed).hours();
  
	document.getElementById('t').innerHTML = '<col width="15"> <col width="150"> <col width="160">';

	for( var i = 0 ; i < topX.length ; i++)
	{
		if( i == topXn ) break;
		
		var
		m = topX[i]['times']['primary'].split('PT')[1].split('M')[0]+'m ',
		s = topX[i]['times']['primary'].split('PT')[1].split('M')[1].split('.')[0].split('S')[0] + 's ' ,
		ms;
		withoutobsoleteruns[i]['times']['primary'].split('PT')[1].split('M')[1].split('.').length == 1 ?
		ms = '' : ms = withoutobsoleteruns[i]['times']['primary'].split('PT')[1].split('M')[1].split('.')[1].split('S')[0]+'ms';
		
		document.getElementById('t').innerHTML += 
		'<tr> <td style="text-align: center; padding-right: 0px; "  > '+ (i+1 < 4 ? '<img class="trophy" src="https://www.speedrun.com/themes/goiwbf/'+ (i+1 == 1? '1st' : (i+1 == 2?'2nd' : '3rd' ) ) +'.png" >' : '' ) + (i+1) + ' </td> <td style="text-align: center;"> ' + (topX[i]['players'][0]['countrycode'] == ''? '' : '<img src="https://www.speedrun.com/images/flags/'+topX[i]['players'][0]['countrycode']+'.png " class="flags">  ')  + topX[i]['players'][0]['name'] + ' </td> <td style="text-align: center;"> <a target="_blank" href="'+ 
		topX[i]['weblink']  +'">' + m		+ s		+ ms + '</a> '+topX[i]['date']+' </td> </tr>';
	}
}


var sI = 
window.setInterval(function(){

if( completeDate > new Date() )clearInterval(sI);

  document.getElementById('shownDate').innerHTML = 
	 completeDate.getFullYear() 
	+ '-'+( (completeDate.getMonth()+1) < 10 ? '0'+ (completeDate.getMonth()+1) : (completeDate.getMonth()+1) )
	+ '-'+completeDate.getDate() +
	' ' + (completeDate.getHours() < 10 ? '0'+completeDate.getHours() : completeDate.getHours() )  + ':0' +completeDate.getMinutes()+ ':0' +completeDate.getSeconds() + ' UTC+0';
  
  getRuns();
  
}, 65);

function pause()
{

	clearInterval(sI);

}
function play()
{

clearInterval(sI);

	sI = 
window.setInterval(function(){

if( completeDate > new Date() )clearInterval(sI);

  document.getElementById('shownDate').innerHTML = 
	 completeDate.getFullYear() 
	+ '-'+( (completeDate.getMonth()+1) < 10 ? '0'+ (completeDate.getMonth()+1) : (completeDate.getMonth()+1) )
	+ '-'+completeDate.getDate() +
	' ' + (completeDate.getHours() < 10 ? '0'+completeDate.getHours() : completeDate.getHours() )  + ':0' +completeDate.getMinutes()+ ':0' +completeDate.getSeconds() + ' UTC+0';
  
  getRuns();
  
}, 65);

}

function rewind()
{

clearInterval(sI);

	sI = 
window.setInterval(function(){

if( completeDate <= startingDate )clearInterval(sI);

  document.getElementById('shownDate').innerHTML = 
	 completeDate.getFullYear() 
	+ '-'+( (completeDate.getMonth()+1) < 10 ? '0'+ (completeDate.getMonth()+1) : (completeDate.getMonth()+1) )
	+ '-'+completeDate.getDate() +
	' ' + (completeDate.getHours() < 10 ? '0'+completeDate.getHours() : completeDate.getHours() )  + ':0' +completeDate.getMinutes()+ ':0' +completeDate.getSeconds() + ' UTC+0';
  
  getRunsRewind();
  
}, 65);

}
  
var pickerDate;
function pp()
{ pickerDate = new Picker(document.querySelector('.js-full-picker'), {
  controls: true,
  format: 'YYYY-MM-DD HH:mm:ss',
});}

function changeDate()
{
	completeDate = new Date(datepicker.value.split(' ')[0].split('-')[0],datepicker.value.split(' ')[0].split('-')[1]-1,datepicker.value.split(' ')[0].split('-')[2],datepicker.value.split(' ')[1].split(':')[0],datepicker.value.split(' ')[1].split(':')[1],datepicker.value.split(' ')[1].split(':')[2]);
	getRuns();
	document.getElementById('shownDate').innerHTML = 
	 completeDate.getFullYear() 
	+ '-'+( (completeDate.getMonth()+1) < 10 ? '0'+ (completeDate.getMonth()+1) : (completeDate.getMonth()+1) )
	+ '-'+completeDate.getDate() +
	' ' + (completeDate.getHours() < 10 ? '0'+completeDate.getHours() : completeDate.getHours() )  + ':0' +completeDate.getMinutes()+ ':0' +completeDate.getSeconds() + ' UTC+0';
  
}

</script>


<body>




<center>

<br>
<div  class="row" style="width: 86%;height: 13px;" > <div class="col-md-1"> <a href="https://www.twitch.tv/as13b" target="_blank"> <img style="width: 222px;height: 39px;opacity: 0.7;" src="logo.png" /> </a> </div>  </div>
<br>

<div class="container" style="color: #1b1b1b;">

 <br><div style="font-weight: bold;font-size: 30px;font-family: Arial; padding-bottom: 10px;">Getting Over It Leaderboard <div style="font-size: 13px;">from start until 15 December 2020</div></div>


<div style="font-weight: bold;font-size: 19px;font-family: Arial; ">

<input class="btn btn-default"  type="button" onclick="pause(); completeDate = new Date(2017,09,21,0,0,0); play();"  value ="" style="width: 80px;height: 52px;font-size: 35px;background-image: url(replay.png);border: 2px solid #00000082; opacity: 0.8;" />
<input class="btn btn-default"  type="button" onclick="rewind()"  value ="" style="width: 80px;height: 52px;font-size: 35px;background-image: url(rewind.png);border: 2px solid #00000082; opacity: 0.8;" />
<input class="btn btn-default"  type="button" onclick="pause()" value="" style="width: 80px;height: 52px;font-size: 35px;background-image: url(pause.png);border: 2px solid #00000082; opacity: 0.8;" />
<input class="btn btn-default"  type="button" onclick="play()"  value ="" style="width: 80px;height: 52px;font-size: 35px;background-image: url(play.png);border: 2px solid #00000082; opacity: 0.8;" />

<br/>
<br/>


 <label for="hours">Speed (hours): </label>

<select id="hours" style="padding-top: 4px;height: 32px;padding-bottom: 5px;">
  <option value="1" onclick="speed = 1;">1</option>
  <option value="2" onclick="speed = 2;">2</option>
  <option value="3" onclick="speed = 3;">3</option>
  <option value="4" onclick="speed = 4;">4</option>
  <option value="5" onclick="speed = 5;">5</option>
  <option value="6" selected onclick="speed = 6;">6</option>
  <option value="7" onclick="speed = 7;">7</option>
  <option value="8" onclick="speed = 8;">8</option>
  <option value="9" onclick="speed = 9;">9</option>
  <option value="10" onclick="speed = 10;">10</option>
  <option value="11" onclick="speed = 11;">11</option>
  <option value="12" onclick="speed = 12;">12</option>
  <option value="13" onclick="speed = 13;">13</option>
  <option value="14" onclick="speed = 14;">14</option>
  <option value="15" onclick="speed = 15;">15</option>
  <option value="16" onclick="speed = 16;">16</option>
  <option value="17" onclick="speed = 17;">17</option>
  <option value="18" onclick="speed = 18;">18</option>
  <option value="19" onclick="speed = 19;">19</option>
  <option value="20" onclick="speed = 20;">20</option>
  <option value="21" onclick="speed = 21;">21</option>
  <option value="22" onclick="speed = 22;">22</option>
  <option value="23" onclick="speed = 23;">23</option>
  <option value="24" onclick="speed = 24;">24</option>
</select> 

 Pick a date : <input type="text" id="datepicker" onclick="pp()" onChange="changeDate()" class="form-control js-full-picker" value="2017-10-21 00:00:00">

</div>
 <br/>
 Top X: <input type="text" id="topX" onChange="topXn = this.value; getRuns();" value="10">


</div>

<br/>

<div id="shownDate" style="font-weight: bold;font-size: 30px;font-family: Arial;margin-bottom: 10px; color: #dcdcdc; " ></div>


<table id="t"  class=" table table-borderless table-hover" style=" background-color: #000000c4;color: #bbb;width: 85%;">

</table>


</div>
</center>


</body>

</html>
